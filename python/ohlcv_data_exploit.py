import pandas as pd
from datetime import datetime

filepath = 'csv_exports/kucoin_USDTDAI_2021-04-19 00:00:00_2021-05-19 00:00:00.csv'

df = pd.read_csv(filepath, sep=";")

print("start script")


def timestamp_to_datetime(i):
    print("inside timestamp")
    i_fixed = i / 1000
    time_converted = datetime.fromtimestamp(i_fixed)
    # import pdb; pdb.set_trace()
    return time_converted


def replace_timestamp_in_df():
    print("inside replace")
    dt_object = df['timestamp']
    # dt_list = map(timestamp_to_datetime, dt_object)
    # df['timestamp'].replace(dt_list)
    # for i in dt_object
    # import pdb; pdb.set_trace()
    for index, timestamp in enumerate(dt_object):
        # print("Line {}: {}".format(index, dt_object))
        timestamp_values = []
        timestamp_values.concat(dt_object[index])
        datetime_values = []
        import pdb; pdb.set_trace()
        datetime_values.concat(timestamp_to_datetime(timestamp_values[index]))
        import pdb; pdb.set_trace()
        print("THATS A ROW(?)", datetime_values)


def main():
    print("main")
    replace_timestamp_in_df()


if __name__ == '__main__':
    main()

main()
